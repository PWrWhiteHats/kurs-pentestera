# Kurs Pentestera 1 - spotkanie nr 3

<p align="center">
  <img src="../logo.png"  width="30%" height="30%" alt="Logo Koła"/>
</p>

---

W trakcie tych zajęć wykorzystana zostanie podatność adresacji ARP w sieci.

Tablice ARP tworzone są na każdym urządzeniu w celu przyspieszenia komunikacji w sieci. Są tam korelowane MAC adresy z prywatnymi adresami IP. Dzięki temu przy każdej transmisji danych nie szukamy adresu MAC z pośród wszystkich dostępnych adresów IP. 

Ma to swoje minusy - możemy manipulować tablicą ARP i w kółko wysyłać rozgłoszenie do routera, że to my jesteśmy klientem o takim IP, a do klienta, że to my jesteśmy routerem. Dzięki temu cały ruch przechodzi przez nasz komputer. 

## Przydatne polecenia

- Mówimy ofierze, że jesteśmy routerem 
```bash
arpspoof -i [interfejs] -t [IP ofiary] [IP routera] 
```

- Mówimy routerowi, że jesteśmy ofiarą 
```bash
arpspoof -i [interfejs] -t [IP routera] [IP ofiary] 
```

> Obie komendy powinny działać równocześnie 

Pamiętać należy również o odblokowaniu ruchu, aby ten nie zatrzymywał się na komputerze atakującego. 
```bash
echo 1 > /proc/sys/net/ipv4/ip_forwarding 
```

> W tym momencie cały ruch, który generuje ofiara przechodzi przez nas. My możemy go zarówno modyfikować jak i sprawdzać co zostało już wysłane/odebrane. Jeżeli wejdziemy na przykład w WireShark-a możemy podejrzeć cały ruch i np. odnaleźć hasło poprzez filtr http i metodę POST. 

Problem zaczyna się kiedy generowany jest ruch po https (większość dzisiejszych stron). Wtedy potrzebujemy narzędzia **SSLStrip**. Przykładowa składnia: 
```bash
sslstrip -l 8080
```

Polecenie to przekierowuje stronę z https na zwykłą nieszyfrowaną http. Metoda nie działa na lepsze strony, które najprawdopodobniej działają po HSTS. 

## Bettercap

Do przeprowadzenia tego ataku stworzony został rownież cały framework **Bettercap** (nie jest to jego jedyne zastosowanie ale umożliwia je). Znaleźć go można [tutaj](https://github.com/bettercap/bettercap)

## Podsumowanie

Więcej informacji możecie również znaleźć [tutaj](http://www.cybersafeness.pl/arpspoof-czyli-mitm-krok-po-kroku/)


## Nmap

Nmap ogółem nazywany "narzędziem" tak naprawdę jest połączeniem kodu dostarczonego przez deweloperów z wieloma rozwiązaniami osadzonymi w większości systemów operacyjnych - w taki sposób, aby móc z ich wykorzystaniem prowadzić analizę zarówno sieci, jak i konkretnych hostów.

### Przełączki

**Dostępne typy skanów:**
- `-sT` - "TCP Scan" - skan polegający na nawiązaniu z usługą pełnego three-way-handshake'a, gdzie wymieniane zostają:
	- SYN
	- SYN/ACK
	- ACK - typowa komunikacja z wykorzystaniem handshake'a Serwer może dalej przesyłać pakiety
- `-sS` - "Syn Scan" - skan polegający na nawiązaniu z usługą niepełnego three-way-handshake'a, gdzie wysłany zostaje:
	- SYN
	- SYN/ACK
	- RST - to zapobiega kontynuacji wysyłaniu przez Serwer dalszych pakietów komunikacji
- `-sU` - "UDP Scan" - skan wysyłający pakiety UDP na dany port gdzie **nie spodziewamy się żadnej odpowiedzi** - w takim przypadku zakłada się że port jest w stanie *open|filtered*. W przypadku wysłania pakietu UDP na zamknięty port - host powinien odpowiedzieć pakietem ICMP zawierającym informację o nieosiągalności portu.
- `-sN` - "NULL Scan" - wysyłane jest żądanie TCP, które nie zawiera żadnej flagi (wszystkie ustawione są na zero) - taki pakiet nic sobą nie reprezentuje, jednakże zgodnie z *RFC (Request for Comments)* host otrzymując taki pakiet na zamknięty port - powinien odpowiedzieć wysyłką flagi **RST**.
- `-sF` - "FIN Scan" - wysyłane jest żadanie z ustawioną wyłącznie flagą **FIN**, w przypadku zamkniętego portu ponownie oczekiwany jest pakiet z odpowiedzią zawierający podniesioną flagę **RST**.
- `-sX` - "Xmas Scan" - ponownie, skan oczekujący odpowiedzi w postaci flagi **RST** w przypadku zamkniętego portu. Nazwa odnosi się do ustawienia w żądaniu flag **PSH**, **URG** oraz **FIN** co w podglądzie Wiresharkowym podobno wygląda jak światełka choinkowe z naprzemiennie mrugającymi lampkami.

**Skanowanie sieci:**
 - `-sn` - Ping scan - wyłączone zostaje skanowanie portów, sprawdza się jedynie odpowiedzi pakietów ICMP od skanowanych hostów
 - Sposoby zapisu przedziału adresów IP:
	 - `nmap -sn 192.168.0.1-254`
	 - `nmap -sn 192.168.0.0/24`
	 - `nmap -sn 172.16.0.0/16`

**Pozostałe:**
- `-p <port>` - skanowanie konkretnego portu
- `-p <port_start>-<port_stop>` - skanowanie przedziału portów
- `-p-` - skanowanie całego zakresu ~65000 portów
- `-sV` - sprawdzanie wersji usługi wystawionej na danym porcie
- `-Pn` - traktuj każdego hosta jako wystawionego - pomija etap *host discovery*